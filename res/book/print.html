<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="overview/whatis.html"><strong aria-hidden="true">1.</strong> What is USDI</a></li><li class="chapter-item expanded "><a href="overview/benefits.html"><strong aria-hidden="true">2.</strong> Benefits of USDI</a></li><li class="chapter-item expanded "><a href="overview/USDI.html"><strong aria-hidden="true">3.</strong> USDI</a></li><li class="chapter-item expanded "><a href="overview/Vault.html"><strong aria-hidden="true">4.</strong> Vault</a></li><li class="chapter-item expanded "><a href="overview/VaultController.html"><strong aria-hidden="true">5.</strong> VaultController</a></li><li class="chapter-item expanded "><a href="overview/contractBrief.html"><strong aria-hidden="true">6.</strong> Contract</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-usdi"><a class="header" href="#what-is-usdi">What is USDI?</a></h1>
<p>USDi is a stablecoin issued by Interest Protocol and stands for USD with interest. As the name suggests, USDi automatically earns compounding interest without requiring you to stake it anywhere.</p>
<h2 id="deposit-usdc-to-mint-usdi"><a class="header" href="#deposit-usdc-to-mint-usdi">Deposit USDC to mint USDI</a></h2>
<p>You can deposit USDC into the protocol to mint USDi at a 1:1 ratio. USDC deposits are kept in the protocol's <a href="overview/./accounting.html">reserve</a> until they are redeemed.</p>
<p>You can think of depositing USDC as depositing cash into a bank. USDC is like cash, and USDi is like the balance on your checking or savings account that you receive for depositing cash. You can deposit USDC to the protocol to receive USDi, which earns interest. USDi can be used to buy other assets, just as you would use a debit card to pay from your account balance.</p>
<h2 id="redeem-usdi-for-usdc"><a class="header" href="#redeem-usdi-for-usdc">Redeem USDI for USDC</a></h2>
<p>You can burn your USDi to receive USDC at a 1:1 ratio. This USDC comes from the <a href="overview/./accounting.html">reserve</a></p>
<p>The protocol aims to guarantee liquidity for swapping USDi against a diverse range of assets. With enough liquidity, users will rarely need to actually redeem USDi for USDC, just as we do not always need to withdraw cash from the bank to make purchases. However, the fact that USDi can be redeemed for USDC keeps USDi pegged to USDC.</p>
<h2 id="compounding-yield"><a class="header" href="#compounding-yield">Compounding Yield</a></h2>
<p>The interest accrued to <a href="overview/./lending.html">usdi loans</a> net of a protocol fee, is distributed pro rata to all USDi holders in the form of additional USDi. The protocol implements the distribution by <a href="overview/./smart_contracts.html">scaling up</a> the balance of USDi tokens in all addresses so that the value of each USDi remains pegged to $1. This means that USDi is a liquidity provider (LP) token that is liquid. USDi earns yield generated from protocol operations, but remains liquid because it is pegged to $1. </p>
<p>As a result, USDi holders are able to earn compounding yield without staking. This improves gas efficiency because there is no need to switch back and forth between the LP token and the stablecoin. It is especially beneficial to retail investors who spend a higher percentage of their trades on gas fees. Investors no longer have to choose between liquidity and yield; USDi provides both.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="benefits-of-usdi"><a class="header" href="#benefits-of-usdi">Benefits of USDI</a></h1>
<h2 id="usdi-holders-earn-compounding-yield-without-staking"><a class="header" href="#usdi-holders-earn-compounding-yield-without-staking">USDi holders earn compounding yield without staking.</a></h2>
<p>Most stablecoins only earn yield when they are staked. On the other hand, LP tokens do not have enough liquidity to be used as a medium of exchange. This is like having to pay for everything in cash, while every ATM withdrawal costs 10 to 100 dollars in gas fee.</p>
<p>In contrast, USDi is both a stablecoin and an LP token. Because it is an LP token, all circulating USDi continuously and automatically accrues interest. Because USDi is a stablecoin, you can use it directly to purchase other assets without redeeming it for USDC.</p>
<p>You can simply hold USDi in your wallet and watch your balance grow. An investor providing ETH-USDi liquidity to an automated market maker earns interest on the USDi portion of their liquidity.</p>
<h2 id="usdi-is-stable"><a class="header" href="#usdi-is-stable">USDI is stable</a></h2>
<p>The safest way to peg a stablecoin is to back it by assets. USDi is always over-collateralized by a combination of USDC reserves and collateral posted by borrowers. </p>
<h2 id="usdi-is-scalable"><a class="header" href="#usdi-is-scalable">USDI is scalable</a></h2>
<p>Anyone can mint USDi by either depositing USDC or posting collateral and borrowing USDi. At a given interest rate, users can borrow more USDi than other major stablecoins.</p>
<h2 id="borrowing-usdi-is-capital-efficient"><a class="header" href="#borrowing-usdi-is-capital-efficient">Borrowing USDI is capital efficient</a></h2>
<p>Compared to existing lenders, at any given interest rate, Interest Protocol is able to make generate more loans without incurring additional liquidity risk. This efficiency gain is shared by all users of the protocol. Borrowers can borrow more at lower rates, and each additional loan creates more USDi holders who earn yield. Holders of the protocolâ€™s governance tokens, called <a href="overview/./tokenomics.html">Interest Protocol Tokens (ITP)</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usdi"><a class="header" href="#usdi">USDI</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vault"><a class="header" href="#vault">Vault</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Interest Protocol vaults are multi-collateral vaults. Each borrower must create a vault and deposit collateral assets to borrow USDi. Assets in vaults are not rehypothicated and are only asseciable to the protocol in the event of a liquidation. </p>
<p>Governance participants will be excited to know they can use their governance tokens as collateral on Interest Protocol and retain voting power by delegating votes from their vault to their regular voting address. </p>
<h2 id="constructor"><a class="header" href="#constructor">Constructor</a></h2>
<p>Each vault is assigned an ID, minter, master_address, and usdi_address. </p>
<ul>
<li>uint256 id
<ul>
<li>the number of the vault. Increases from 0. </li>
</ul>
</li>
<li>address minter
<ul>
<li>the owner of the vault.</li>
</ul>
</li>
<li>address master_address
<ul>
<li>where the vault references for access to the protocol.</li>
</ul>
</li>
<li>address usdi_address
<ul>
<li>the address of the dollar synth.</li>
</ul>
</li>
</ul>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<ul>
<li>function getMinter()
<ul>
<li>the owner of the vault. </li>
</ul>
</li>
<li>function BaseLiability()
<ul>
<li>the amount of USDi borrowed by the vault. </li>
</ul>
</li>
<li>function withdraw_erc20(address token_address, uint256 amount)
<ul>
<li>to withdraw collateral assets.</li>
</ul>
</li>
<li>function masterTransfer(address _token, address _to, uint256 _amount)
<ul>
<li>to transfer colllateral from the vault to the protocol for liquidation.</li>
</ul>
</li>
<li>function decrease_liability(uint256 base_amount)
<ul>
<li>decrease the account liability upon repayment or liquidation.</li>
</ul>
</li>
<li>function increase_liability(uint256 base_amount)
<ul>
<li>increase the account liability upon borrow.</li>
</ul>
</li>
<li>function delegateCompLikeTo(address compLikeDelegatee, address CompLikeToken)
<ul>
<li>delegate votes of a collateral asset with voting capability an address for voting.</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vaultcontroller"><a class="header" href="#vaultcontroller">VaultController</a></h1>
<h2 id="overview-1"><a class="header" href="#overview-1">Overview</a></h2>
<p>The VaultController is the brain of the protocol. It is responsible for adding and mananging collateral assets, handling liquidations of Vaults and of course, lending  USDi.</p>
<p>Each Vault is minted from the VaultController and references the controller for access to the protocol. </p>
<p>The VaultController is purposely simple and adaptable. Governance can upgrade the contract to make complex changes or stick to regular changes on onlyOwner functions such as:</p>
<ol>
<li>register_oracle_master</li>
<li>register_curve_master</li>
<li>change_protocol_fee</li>
<li>register_erc20</li>
<li>update_registered_erc20</li>
</ol>
<h2 id="initialize"><a class="header" href="#initialize">Initialize</a></h2>
<pre><code>function initialize() external override initializer {
__Ownable_init();
_vaultsMinted = 0;
_tokensRegistered = 0;
_interestFactor = 1e18; // initialize at 1e18;
_totalBaseLiability = 0;
_protocolFee = 1e14;
_lastInterestTime = block.timestamp;
}
</code></pre>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<ul>
<li>function InterestFactor() external view override returns (uint256)
<ul>
<li>Returns the interest factor</li>
</ul>
</li>
<li>function ProtocolFee() external view override returns (uint256)
<ul>
<li>Returns the protocol fee.</li>
</ul>
</li>
<li>function VaultAddress(uint256 id) external view override returns (address)
<ul>
<li>Returns a Vault address with input of a Vault ID.</li>
</ul>
</li>
<li>function mint_vault() public override returns (address)
<ul>
<li>Mints a Vault to the msg.sender</li>
</ul>
</li>
<li>function register_usdi(address usdi_address) external override onlyOwner
<ul>
<li>Registers USDi with the controller.</li>
</ul>
</li>
<li>function register_oracle_master(address master_oracle_address) external override onlyOwner
<ul>
<li>Registers the OracleMaster with the controller.</li>
</ul>
</li>
<li>function register_curve_master(address master_curve_address) external onlyOwner
<ul>
<li>Registers the CurveMaster with the controller.</li>
</ul>
</li>
<li>function change_protocol_fee(uint256 new_protocol_fee) external onlyOwner
<ul>
<li>Updates the protocol fee. </li>
</ul>
</li>
<li>function register_erc20(address token_address, uint256 LTV, address oracle_address, uint256 liquidationIncentive) external onlyOwner
<ul>
<li>Adds a collateral asset to the protocol. Governance must set a liquidation token value, setup an oracle configuration, and choose a liquidation incentive.</li>
</ul>
</li>
<li>function update_registered_erc20(address token_address, uint256 LTV, address oracle_address, uint256 liquidationIncentive) external onlyOwner
<ul>
<li>Same as registeration but for updating an existing market.</li>
</ul>
</li>
<li>function check_account(uint256 id) external view override returns (bool)
<ul>
<li>Checks if an account is ready for liquidation. </li>
</ul>
</li>
<li>function borrow_usdi(uint256 id, uint256 amount) external override
<ul>
<li>For a vault to borrow USDi.</li>
</ul>
</li>
<li>function repay_usdi(uint256 id, uint256 amount) external override
<ul>
<li>For a vault to repay some number of USDi.</li>
</ul>
</li>
<li>function repay_all_usdi(uint256 id) external override
<ul>
<li>For a vault to repay their entire liability.</li>
</ul>
</li>
<li>function liquidate_account(uint256 id, address asset_address, uint256 tokens_to_liquidate) external override returns (uint256)
<ul>
<li>Liquidates a vault to get it back to minimum solvency (and allows for partial fill).</li>
</ul>
</li>
<li>function TokensToLiquidate(uint256 id, address asset_address, uint256 tokens_to_liquidate) public view returns (uint256)
<ul>
<li>An external call that liquidators can use to find the maximum amount of tokens of collateral that can be purchased from a vault. Calls _liquidationMath()</li>
</ul>
</li>
<li>function _liquidationMath( uint256 id, address asset_address, uint256 tokens_to_liquidate) internal view returns (uint256, uint256)
<ul>
<li>Calculates the maximum amount of tokens that can be purchased from a vault. Note: liquidation will only liquiate to the point of minimum solvency. </li>
</ul>
</li>
<li>function getVault(uint256 id) internal view returns (IVault vault)
<ul>
<li>Returns vault address with ID input. </li>
</ul>
</li>
<li>function AccountLiability(uint256 id) external view override
<ul>
<li>An external function that returns a Vault's debt with ID input. Calls _AccountLiability</li>
</ul>
</li>
<li>function _AccountLiability(uint256 id) internal view returns (uint256)
<ul>
<li>Returns a Vault's debt to the protocol via Vault ID.</li>
</ul>
</li>
<li>function AccountBorrowingPower(uint256 id) external view returns (uint256)
<ul>
<li>An externall callabel that calls get_vault_borrowing_power</li>
</ul>
</li>
<li>function get_vault_borrowing_power(IVault vault) private view returns (uint256)
<ul>
<li>Returns a vault's borrowing power by looping through all collateral asset, querying prices, checking for balances, and adjusting based off LTV. </li>
</ul>
</li>
<li>function calculate_interest() external override returns (uint256)
<ul>
<li>Calls pay_interest()</li>
</ul>
</li>
<li>function pay_interest() private returns (uint256)
<ul>
<li>Updates the interest rate for borrowers (and thus lenders). Acccures interest for lenders and collects the protocol fee. </li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interest-protocol-contracts-brief"><a class="header" href="#interest-protocol-contracts-brief">Interest Protocol Contracts Brief</a></h1>
<h2 id="core-contracts"><a class="header" href="#core-contracts">Core Contracts</a></h2>
<ul>
<li>USDi: a USDC synth. 1:1 to USDC. Interest baring via (Ampleforth) rebasing. The contract is upgradable via governance.</li>
<li>Vault: where a borrower holds their collateral assets.</li>
<li>VaultController: the core math and functionality of the protocol. Each vault references the VaultController. The contract is upgradable via governance</li>
</ul>
<h2 id="auxiliary-contracts"><a class="header" href="#auxiliary-contracts">Auxiliary Contracts</a></h2>
<ul>
<li>CurveMaster: is what the VaultController calls to calculate the borrow rate. Set at the VaultController via address. 
<ul>
<li>ThreeLines0_100: is called by the CurveMaster to calculate the borrow rate.</li>
</ul>
</li>
<li>OracleMaster is what the VaultController calls for prices. Set at the VaultController via address. 
<ul>
<li>AnchoredViewRelay: called by the OracleMaster. It santity checks the anchor against the main price.</li>
<li>ChainlinkOracleRelay: called by the AnchoredViewRelay. Gets the lastestAnswer from a Chainlink oracle. </li>
<li>UniswapV3OracleRelay: called by the AnchoredViewRelay. Calculates the price of x ticks for a UniV3 market.</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
